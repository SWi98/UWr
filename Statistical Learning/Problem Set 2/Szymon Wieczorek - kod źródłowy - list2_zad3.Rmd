---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
N = 210
P = 3221
TEST_N = 30
test_idxs = sample(c(1:N), size=TEST_N, replace=FALSE)
train_idxs = setdiff(c(1:N), test_idxs)

y_test = matrix(Realdata[test_idxs, 1])
x_test = matrix(Realdata[test_idxs, 2:P], ncol=P-1, byrow=FALSE)

y_train = matrix(Realdata[train_idxs, 1])
x_train = matrix(Realdata[train_idxs, 2:P], ncol=P-1, byrow=FALSE)

data = prepare_data(y_train, x_train)

print("AIC")
res = fast_forward(data, crit = aic)
selected_cols = as.integer(res$model)
B_hat = c(t(coef(lm(y_train ~ x_train[, selected_cols]))))[-1]
MSE = sum((x_test[, selected_cols] %*% B_hat - y_test)**2) / TEST_N
MSE

print("BIC")
res = fast_forward(data, crit = bic)
selected_cols = as.integer(res$model)
B_hat = c(t(coef(lm(y_train ~ x_train[, selected_cols]))))[-1]
MSE = sum((x_test[, selected_cols] %*% B_hat - y_test)**2) / TEST_N
MSE

print("mBIC")
res = fast_forward(data, crit = mbic)
selected_cols = as.integer(res$model)
B_hat = c(t(coef(lm(y_train ~ x_train[, selected_cols]))))[-1]
MSE = sum((x_test[, selected_cols] %*% B_hat - y_test)**2) / TEST_N
MSE

print("mBIC2")
res = fast_forward(data, crit = mbic2)
selected_cols = as.integer(res$model)
B_hat = c(t(coef(lm(y_train ~ x_train[, selected_cols]))))[-1]
MSE = sum((x_test[, selected_cols] %*% B_hat - y_test)**2) / TEST_N
MSE
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
